<Project>
	<PropertyGroup>
		<!--<TargetFramework>netstandard2.0</TargetFramework>-->
		<LangVersion>13</LangVersion>

		<!-- Some features we use require a documentation file, like analyzers, and the docs manifest generation -->
		<GenerateDocumentationFile>true</GenerateDocumentationFile>

		<!-- Debug symbols -->
		<DebugType>embedded</DebugType>
		<DebugSymbols>true</DebugSymbols>

		<EmbedUntrackedSources>true</EmbedUntrackedSources>
		<PublishRepositoryUrl>true</PublishRepositoryUrl>

		<!--
			Set compiler in "strict" mode, which enables some checks that weren't enabled by default, due to them being
			breaking changes (i.e. compiling some code fine one version, and then no longer compiling the next).
		-->
		<Features>strict</Features>

		<!--
			Faster NuGet restores
			https://learn.microsoft.com/en-us/nuget/release-notes/nuget-5.5#summary-whats-new-in-55
		-->
		<RestoreUseStaticGraphEvaluation>true</RestoreUseStaticGraphEvaluation>

		<!-- Treat warnings as errors in "Release" builds -->
		<!--
		<TreatWarningsAsErrors Condition=" '$(Configuration)' == 'Release' ">true</TreatWarningsAsErrors>
		<MSBuildTreatWarningsAsErrors Condition="' $(Configuration)' == 'Release' ">true</MSBuildTreatWarningsAsErrors>
		-->

		<!--
			CS8669: The annotation for nullable reference types should only be used in code within a '#nullable' annotations context. Auto-generated code requires an explicit '#nullable' directive in source.
			https://github.com/dotnet/razor/issues/8720
		-->
		<NoWarn>CS8669</NoWarn>

		<!-- Put any generated stuff (including "bin" and  "obj" folders, and NuGet packages) in an "artifacts" folder, instead of spread out across the source. -->
		<!--		<UseArtifactsOutput>true</UseArtifactsOutput>-->
		<ArtifactsPath>$(MSBuildThisFileDirectory)/../artifacts</ArtifactsPath>
	</PropertyGroup>

	<!-- Regular Projects -->
	<PropertyGroup Condition="!$(MSBuildProjectName.EndsWith('Test'))">
		<Nullable>enable</Nullable>

		<!-- Code analysis -->
		<AnalysisLevel>8.0-all</AnalysisLevel>
		<AnalysisMode>all</AnalysisMode>
		<EnableNETAnalyzers>true</EnableNETAnalyzers>
		<EnforceCodeStyleInBuild>true</EnforceCodeStyleInBuild>
		<RunAnalyzers>true</RunAnalyzers>
		<RunAnalyzersDuringBuild>true</RunAnalyzersDuringBuild>
		<RunAnalyzersDuringLiveAnalysis>true</RunAnalyzersDuringLiveAnalysis>
	</PropertyGroup>

	<!-- Unit Test Projects -->
	<PropertyGroup Condition="$(MSBuildProjectName.EndsWith('Test'))">
		<Nullable>annotations</Nullable>

		<!-- Code analysis -->
		<!--		<EnableNETAnalyzers>false</EnableNETAnalyzers>-->
		<!--		<EnforceCodeStyleInBuild>false</EnforceCodeStyleInBuild>-->
		<!--		<RunAnalyzers>false</RunAnalyzers>-->

		<!-- MSTest Platform -->
		<EnableMSTestRunner>true</EnableMSTestRunner>
		<IsPackable>false</IsPackable>
		<IsTestProject>true</IsTestProject>
		<TestingPlatformDotnetTestSupport>true</TestingPlatformDotnetTestSupport>
		<TestingPlatformShowTestsFailure>true</TestingPlatformShowTestsFailure>
	</PropertyGroup>

	<!-- Versioning -->
	<ItemGroup>
		<PackageReference Include="Nerdbank.GitVersioning" PrivateAssets="All"/>
	</ItemGroup>

	<!-- Analyzers -->
	<ItemGroup>
		<PackageReference Include="Microsoft.VisualStudio.Threading.Analyzers">
			<PrivateAssets>all</PrivateAssets>
			<IncludeAssets>runtime; build; native; contentfiles; analyzers; buildtransitive</IncludeAssets>
		</PackageReference>
		<PackageReference Include="SonarAnalyzer.CSharp">
			<PrivateAssets>all</PrivateAssets>
			<IncludeAssets>runtime; build; native; contentfiles; analyzers; buildtransitive</IncludeAssets>
		</PackageReference>
		<PackageReference Include="StyleCop.Analyzers.Unstable">
			<PrivateAssets>all</PrivateAssets>
			<IncludeAssets>runtime; build; native; contentfiles; analyzers; buildtransitive</IncludeAssets>
		</PackageReference>
	</ItemGroup>

	<!-- Test projects -->
	<ItemGroup Condition=" $(MSBuildProjectName.EndsWith('Test')) ">
		<PackageReference Include="Microsoft.Testing.Extensions.CodeCoverage"/>
		<PackageReference Include="Moq"/>
		<PackageReference Include="MSTest"/>
	</ItemGroup>
</Project>